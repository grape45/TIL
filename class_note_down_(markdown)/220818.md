

## 0818 KDT Class_note_down

### ğŸ¯ í•™ìŠµ ëª©í‘œ : ë°ì´í„°ë² ì´ìŠ¤ ê¸°ì´ˆ

#### 1. ê¸°ë³¸ í•¨ìˆ˜ì™€ ì—°ì‚°

1. ë¬¸ìì—´ í•¨ìˆ˜
   - `SUBSTR(ë¬¸ìì—´, start, length)` : ë¬¸ìì—´ ìë¥´ê¸°
     
     - ì‹œì‘ ì¸ë±ìŠ¤ëŠ” 1, ë§ˆì§€ë§‰ ì¸ë±ìŠ¤ëŠ” -1
     
     ```sqlite
     SELECT SUBSTR('SQL practice', -5, 5) AS string;
     -- ctice
     ```
     
   - `TRIM(ë¬¸ìì—´)`, `LTRIM(ë¬¸ìì—´)`, `RTRIM(ë¬¸ìì—´)` : ë¬¸ìì—´ ê³µë°± ì œê±°
   
     ```sqlite
     SELECT TRIM('   SQL practice    ') AS string;
     -- SQL practice
     SELECT LTRIM('      SQL practice') AS string;
     -- SQL practice
     SELECT RTRIM('SQL practice      ') AS string;
     -- SQL practice
     ```
   
   - `LENGHT(ë¬¸ìì—´)` : ë¬¸ìì—´ ê¸¸ì´
   
     ```sqlite
     SELCT LENGTH('SQL practice') AS string;
     -- 12
     ```
   
   - `REPLACE(ë¬¸ìì—´, íŒ¨í„´, ë³€ê²½ê°’)` : íŒ¨í„´ì— ì¼ì¹˜í•˜ëŠ” ë¶€ë¶„ì„ ë³€ê²½
   
     ```sqlite
     SELECT repalce('SQL practice', 'SQL', 'Python') AS string;
     -- Python practice
     ```
   
   - `UPPER(ë¬¸ìì—´)`, `LOWER(ë¬¸ìì—´)` : ëŒ€ì†Œë¬¸ì ë³€ê²½
   
     ```sqlite
     SELECT UPPER('sql practice');
     -- SQL PRACTICE
     SELECT LOWER('SQL PRACTICE');
     -- sql practice
     ```
   
   - `||` : ë¬¸ìì—´ í•©ì¹˜ê¸°(concatenation)
   
     ```sqlite
     -- last_name ìœ  first_name í•˜ì—°
     SELECT last_name || first_name ì´ë¦„ FROM users;
     -- ì´ë¦„
     -- ---
     -- ìœ í•˜ì—°
     ```

2. ìˆ«ì í•¨ìˆ˜

   - `ABS(ìˆ«ì)` : ì ˆëŒ€ê°’

     ```sqlite
     SELECT ABS(-243):
     -- 243
     ```
   
   - `SIGN(ìˆ«ì)` : ë¶€í˜¸ (ì–‘ìˆ˜ : 1, ìŒìˆ˜ : -1, 0 : 0)
   
     ```sqlite
     IF number > 0, it returns 1
     IF number = 0, it returns 0
     IF number < 0, it returns -1
     ```
   
   - `MOD(ìˆ«ì1, ìˆ«ì2)` : ìˆ«ì1ì„ ìˆ«ì2ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€
   
     ```sqlite
     SELECT MODE(18, 5);
     - 3
     ```
   
   - `CEIL(ìˆ«ì)`, `FLOOR(ìˆ«ì)`, `ROUND(ìˆ«ì, ìë¦¬)` : ì˜¬ë¦¼, ë‚´ë¦¼, ë°˜ì˜¬ë¦¼
   
     ```sqlite
     SELECT CEIL(4.12), FLOOR(4.12), ROUND(4.12);
     - 5.0, 4.0, 4.0
     ```
   
   - `POWER(ìˆ«ì1, ìˆ«ì2)` : ìˆ«ì1ì˜ ìˆ«ì2 ì œê³±
   
     ```sqlite
     SELECT POWER(9, 2);
     - 81.0
     ```
   
   - `SQRT(ìˆ«ì)` : ì œê³±ê·¼
   
     ```sqlite
     SELECT SQRT(9);
     - 3.0
     ```
   
   - ì‚°ìˆ  ì—°ì‚°ì
   
     - `+`, `-`, `*`, `/` ì™€ ê°™ì€ ì‚°ìˆ  ì—°ì‚°ìì™€ ìš°ì„  ìˆœìœ„ë¥¼ ì§€ì •í•˜ëŠ” `()` ê¸°í˜¸ë¥¼ ì—°ì‚°ì— í™œ ê°€ëŠ¥
   
       ```sqlite
       SELECT age+1 FROM users;
       ```



#### 2. GROUP BY

1. Aggregate function(ì§‘ê³„í•¨ìˆ˜) ë³µìŠµ

   - ê° ì§‘í•©ì— ëŒ€í•œ ê³„ì‚°ì„ ìˆ˜í–‰í•˜ê³  ë‹¨ì¼ ê°’(ë ˆì½”ë“œ)ì„ ë°˜í™˜
     - ì—¬ëŸ¬ í–‰ìœ¼ë¡œë¶€í„° í•˜ë‚˜ì˜ ê²°ê³¼ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
   - SELECT êµ¬ë¬¸ì—ì„œë§Œ ì‚¬ìš©
   - ì˜ˆì‹œ
     - í…Œì´ë¸” ì „ì²´ í–‰ ìˆ˜ë¥¼ êµ¬í•˜ëŠ” `COUNT(*)`
     - age ì»¬ëŸ¼ ì „ì²´ í‰ê·  ê°’ì„ êµ¬í•˜ëŠ” `AVG(age)`

2. ALIAS

   - ì¹¼ëŸ¼ëª…ì´ë‚˜ í…Œì´ë¸”ëª…ì´ ë„ˆë¬´ ê¸¸ê±°ë‚˜ ë‹¤ë¥¸ ëª…ì¹­ìœ¼ë¡œ í™•ì¸í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
   - ASë¥¼ ìƒëµí•˜ì—¬ ê³µë°±ìœ¼ë¡œ í‘œí˜„ ê°€ëŠ¥
   - ë³„ì¹­ì— ê³µë°±, íŠ¹ìˆ˜ë¬¸ì ë“±ì´ ìˆëŠ” ê²½ìš° ë”°ì˜´í‘œë¡œ ë¬¶ì–´ í‘œê¸°

   ```sqlite
   SELECT last_name ì„± FROM users;
   SELECT last_name AS ì„± FROM users;
   SELECT last_name AS ì„± FROM users WHERE ì„±='ê¹€';
   ```

3. **GROUP BY**

   - "make a set of summary rows from a set of rows"
   - SELECTë¬¸ì˜ optional ì ˆ
   - í–‰ ì§‘í•©ì—ì„œ ìš”ì•½ í–‰ ì§‘í•©ì„ ë§Œë“¦
   - ì„ íƒëœ í–‰ ê·¸ë£¹ì„ í•˜ë‚˜ ì´ìƒì˜ ì—´ ê°’ìœ¼ë¡œ ìš”ì•½ í–‰ìœ¼ë¡œ ë§Œë“¦
   - **ë¬¸ì¥ì— WHERE ì ˆì´ í¬í•¨ëœ ê²½ìš° ë°˜ë“œì‹œ WHERE ì ˆ ë’¤ì— ì‘ì„± â­ï¸** 

   ```sqlite
   SELECT * FROM í…Œì´ë¸”ì´ë¦„ GROUP BY ì»¬ëŸ¼1, ì»¬ëŸ¼2;
   ```

   - ì§€ì •ëœ ì»¬ëŸ¼ì˜ ê°’ì´ ê°™ì€ í–‰ë“¤ë¡œ ë¬¶ìŒ
   
   - GROUP BY WHERE

     ```sqlite
     -- ì˜ˆì‹œ : 100ë²ˆ ì´ìƒ ë“±ì¥í•œ ì„±ë§Œ ì¶œë ¥
     SELECT last_name, COUNT(last_name) FROM users WHERE COUNT(last_name) > 100 GROUP BY last_name;
     
     -- OUTPUT -> Parse error : misuse of aggregate : COUNT()
     
     -- HOW to Solve? -> ì¡°ê±´ì— ë”°ë¥¸ GROUP = HAVINGì ˆ ì‚¬ìš©
     SELECT last_name, COUNT(last_name) FROM users GORUP BY last_name HAVING COUNT(last_name) > 100;
     ```
   
   - **HAVING** â­ï¸
   
     - ì§‘ê³„í•¨ìˆ˜ëŠ” WHEREì ˆì˜ ì¡°ê±´ì‹ì—ì„œëŠ” ì‚¬ìš© ë¶ˆê°€(ì‹¤í–‰ ìˆœì„œì— ì˜í•´)
     - WHEREë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ GROUP BY ê·¸ë£¹í™”ë³´ë‹¤ ìˆœì„œìƒ ì•ì— ìˆê¸° ë•Œë¬¸ì„
     - ì§‘ê³„ ê²°ê³¼ì—ì„œ ì¡°ê±´ì´ ë§ˆì¦Œ ê°’ì„ ë”°ë¡œ í™œìš©í•˜ê¸° ìœ„í•´ HAVING ì‚¬ìš©
   
   - **ì§‘ê³„í•¨ìˆ˜ì™€ í™œìš©í•˜ì˜€ì„ ë•Œ ì˜ë¯¸ê°€ ìˆìŒ** â­ï¸
   
   - GROUP BY í™œìš©í•˜ëŠ” ì»¬ëŸ¼ì„ ì œì™¸í•˜ê³ ëŠ” ì§‘ê³„í•¨ìˆ˜ ì‚¬ìš©!!!
   
     - GROUP BY í™œìš©í•˜ëŠ” ì»¬ëŸ¼ì„ ì œì™¸í•œ ì»¬ëŸ¼ë“¤ì€ ì¶œë ¥ì‹œì¼œë„ ì˜ë¯¸ ì—†ëŠ” ì¶œë ¥ ê°’ì´ ë‚˜ì˜´
   
       ```SQLITE
       SELECT last_name, age, COUNT(*) FROM users GROUP BY last_name;
       ```
   
     - ê° last_name ë³„ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ì „ì²´ì—ì„œ last_nameì˜ ìˆ˜ë¥¼ ì¶œë ¥, **ì´ë•Œì˜ age ì¶œë ¥ ê°’ì€ ì˜ë¯¸ ì—†ëŠ” ê°’**
   
     - ë§Œì•½, ì´ë•Œì˜ ageë¥¼ last_name ë³„ë¡œ í‰ê·  ë‚˜ì´ë¥¼ êµ¬í•˜ê³ ì í•œë‹¤ë©´,
   
       ```sqlite
       SELECT last_name, AVG(age), COUNT(*) FROM users GROUP BY last_name;
       ```
   
     - GROUP BYëŠ” **ê²°ê³¼ê°€ ì •ë ¬ë˜ì§€ ì•Šê³  ê¸°ì¡´ ìˆœì„œì™€ ë°”ë€œ**
   
     - ì›ì¹™ì ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì •ë ¬í•´ì„œ ë³´ê³  ì‹¶ë‹¤ë©´, **ORDER BY** ì‚¬ìš©
   
   - ê·¸ë£¹í™”ëœ ê°ê°ì˜ ê·¸ë£¹ì´ í•˜ë‚˜ì˜ ì§‘í•©ìœ¼ë¡œ ì§‘ê³„í•¨ìˆ˜ì˜ ì¸ìˆ˜ë¡œ ë„˜ê²¨ì§
   
   ```sqlite
   SELECT * FROM users GROUP BY last_name;
   ```
   
   > DISTINCT ì™€ ë³„ê°œì„ !!!! <ì§‘ê³„í•¨ìˆ˜ì™€ í™œìš©> ì‹œ ìœ ì˜ë¯¸í•¨
   
   âœï¸ SELECT ë¬¸ì¥ í•´ì„ ìˆœì„œ
   
   ```BASH
   FROM â¡ï¸ WHERE â¡ï¸ GROUP BY â¡ï¸ HAVING â¡ï¸ SELECT â¡ï¸ ORDER BY â¡ï¸ LIMIT/OFFSET
   ```
   
   > `FROM` + í…Œì´ë¸”ëª… : í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ
   >
   > `WHERE` + ì¡°ê±´ì‹ : ì œì•½ì¡°ê±´ì— ë§ì¶° ë½‘ì•„ì„œ
   >
   > `GROUP BY` + ì¹¼ëŸ¼ or í‘œí˜„ì‹ : ê·¸ë£¹í™”í•œë‹¤
   >
   > `HAVING` + ê·¸ë£¹ì¡°ê±´ì‹ : ê·¸ë£¹ ì¤‘ì— ì¡°ê±´ê³¼ ë§ëŠ” ê²ƒë§Œì„
   >
   > `SELECT` + ì¹¼ëŸ¼ëª… : ì¡°íšŒí•˜ì—¬
   >
   > `ORDER BY` + ì¹¼ëŸ¼ or í‘œí˜„ì‹ : ì •ë ¬í•˜ê³ 
   >
   > `LIMIT/OFFSET` + ìˆ«ì : íŠ¹ì • ìœ„ì¹˜ì˜ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤
   
   

#### 3. ALTER TABLE

1. í…Œì´ë¸” ì´ë¦„ ë³€ê²½
2. ìƒˆë¡œìš´ column ì¶”ê°€
3. column ì´ë¦„ ìˆ˜ì •(new in sqlite 3.25.0)
4. column ì‚­ì œ(new in sqlite 3.35.0)

```sqlite
-- 1. í…Œì´ë¸” ì´ë¦„ ë³€ê²½
ALTER TABLE table_name RENAME TO new_name;

-- 2. ìƒˆë¡œìš´ column ì¶”ê°€
ALTER TABLE table_name ADD COLUMN column_definition;

-- 3. column ì´ë¦„ ìˆ˜ì •
ALTER TABLE table_name RENAME_COLUMN curren_name TO new_name;

-- 4. column ì‚­ì œ
ALTER TABLE table_name DROP COLUMN column_name;
```

