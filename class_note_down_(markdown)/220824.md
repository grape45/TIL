## 0824 KDT Class_note_down

### ğŸ¯ í•™ìŠµ ëª©í‘œ : ë°ì´í„°ë² ì´ìŠ¤ í™œìš© 

#### 1. ORM(Object Relational Mapping)

- ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ìœ í˜•ì˜ ì‹œìŠ¤í…œ ê°„ì˜ ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ìˆ 
- íŒŒì´ì¬ì—ì„œëŠ” SQLAIchemy, peewee ë“± ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆìœ¼ë©°, Django í”„ë ˆì„ì›Œí¬ì—ì„œëŠ” ë‚´ì¥ Django ORMì„ í™œìš©

- "ê°ì²´(object)ë¡œ DBë¥¼ ì¡°ì‘í•œë‹¤"

  ```sqlite
  Genre.objects.all()
  ```

- DB ì¡°ì‘(ê´€ë¦¬) ì‹œ ëª¨ë¸ë§ íŒŒíŠ¸, í…Œì´ë¸” ì¡°ì‘ íŒŒíŠ¸ê°€ ë”°ë¡œ ì¡´ì¬

  - ëª¨ë¸ë§ í•  ë• class ìƒì„±, í…Œì´ë¸” ì¡°ì‘ í•  ë• Migration â­ï¸
  - ì°¸ê³ ) CRUD Operationì€ ê°ì²´ë¥¼ ì¡°ì‘í•˜ë©´ì„œ ì‘ë™
  - ëª¨ë¸ ì„¤ê³„ ë° ë°˜ì˜

  ```sqlite
  - 1. í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ë‚´ê°€ ì›í•˜ëŠ” DBì˜ êµ¬ì¡°ë¥¼ ë§Œë“¦
  class Genre(models.Model):
  	name = models.CharField(max_length = 30)
  	
  - 2. í´ë˜ìŠ¤ì˜ ë‚´ìš©ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ê¸° ìœ„í•œ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ 'ìë™' ìƒì„±
  $ python manage.py makemigrations
  
  - 3. DBì— migrate
  $ python manage.py migrate
  ```

  > Migration(ë§ˆì´ê·¸ë ˆì´ì…˜)
  >
  > - Modelì— ìƒê¸´ ë³€í™”ë¥¼ DBì— ë°˜ì˜í•˜ê¸° ìœ„í•œ ë°©ë²•
  > - ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ë§Œë“¤ì–´ DB ìŠ¤í‚¤ë§ˆë¥¼ ë°˜ì˜
  > - ëª…ë ¹ì–´
  >   - `makemigrations` : ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
  >   - `migrate` : ë§ˆì´ê·¸ë ˆì´ì…˜ì„ DBì— ë°˜ì˜

  - Migrate ì‚´í´ë³´ê¸°

  ```sqlite
  BEGIN;
  --
  -- Create model Genre
  -- 
  CREATE TABLE "db_genre" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "name" varchar(30 NOT NULL);
  COMMIT;
  
  -- cf) íŠ¸ëœì­ì…˜
  ```

- ë°ì´í„°ë² ì´ìŠ¤ ì¡°ì‘(Database API)

  ```bash
  Genre.         objects.     all()
  #Class Name    #MANAGER     #QuerySet API
  ```

  

#### 2. ORM ê¸°ë³¸ ì¡°ì‘

- Create

  ```sqlite
  # 1. create ë©”ì„œë“œ í™œìš©
  Genre.objects.create(name = 'ë°œë¼ë“œ')
  
  # 2. ì¸ìŠ¤í„´ìŠ¤ ì¡°ì‘
  genre = Genre()
  genre.name = 'ì¸ë””ë°´ë“œ'
  genre.save()
  ```

  **âœï¸ `Get`ê³¼ `Filter`ì˜ ì°¨ì´** â­ï¸

  ```PYTHON
  In [14]: Genre.objects.get(id=1)
  Out[14]: <Genre: Genre object (1)>
  -> ë°˜ë“œì‹œ í•˜ë‚˜. ì—†ê±°ë‚˜, ë§ìœ¼ë©´ ì˜¤ë¥˜ ë„ì›€
  -> PK : PRIMARY KEY ì‚¬ìš©ì€ get ì‚¬ìš©
  
  In [15]: Genre.objects.filter(id=1)
  Out[15]: <QuerySet [<Genre: Genre object (1)>]>
  -> ë¬´ì¡°ê±´ ê²°ê³¼ê°€ QuerySet(ì¼ì¢…ì˜ ë¦¬ìŠ¤íŠ¸)
  ```

- Read

  ```python
  # 1. ì „ì²´ ë°ì´í„° ì¡°íšŒ
  Genre.objects.all()
  # <QuerySet [<Genre: Genre object (1)>, <Genre: Genre object (2)>, <Genre: Genre object (3)>]>
  
  # 2. ì¼ë¶€ ë°ì´í„° ì¡°íšŒ(get)
  Genre.objects.get(id=1)
  # <Genre: Genre object (1)>
  
  # 3. ì¼ë¶€ ë°ì´í„° ì¡°íšŒ(filter)
  Genre.objects.filter(id=1)
  # <QuerySet [<Genre: Genre object (1)>]>
  ```

- Update

  ```python
  # CreateëŠ” ì²˜ìŒë¶€í„° ìƒˆë¡œ ë§Œë“œëŠ” ê²ƒ, UpdateëŠ” ê¸°ì¡´ í…Œì´ë¸”ì„ ê°€ì ¸ì™€ì„œ ìˆ˜ì •í•˜ëŠ” ê²ƒ
  
  # 1. genre ê°ì²´ í™œìš©
  genre = Genre.objects.get(id=1)
  
  # 2. genre ê°ì²´ ì†ì„± ë³€ê²½
  genre.name = 'íŠ¸ë¡œíŠ¸'
  
  # 3. genre ê°ì²´ ì €ì¥
  genre.save()
  ```

- Delete

  ```python
  # 1. genre ê°ì²´ í™œìš©
  genre = Genre.objects.get(id=1)
  
  # 2. genre ê°ì²´ ì‚­ì œ
  genre.delete()
  
  # ì´ë ‡ê²Œë„ ì‚¬ìš© ê°€ëŠ¥
  Genre.objects.get(id=1).delete()
  # íŒŒì´ì¬ì—ì„œ '  abc  '.strip().upper() ê°™ì€ ëŠë‚Œìœ¼ë¡œ ì‘ë™
  ```

- Artist ëª¨ë¸ ìƒì„±

  ```python
  class Artist(models.Model);
  	name = models.CharField(max_length=30)
    debut = models.DateField()
  ```

âœï¸ **ê¿ˆì—ì„œë„ ìŠì§€ ë§ì, ë§ˆì´ê·¸ë ˆì´ì…˜!!!**

- ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„± â¡ï¸ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ DBì— ë°˜ì˜

  ```python
  $ python manage.py makemigrations
  $ python manage.py migrate
  ```

  

